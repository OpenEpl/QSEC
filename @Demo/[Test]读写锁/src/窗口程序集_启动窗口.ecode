.程序集 窗口程序集_启动窗口, 窗口: _启动窗口
.程序集变量 读写锁, 整数型

.子程序 __启动窗口_创建完毕

读写锁 = 读写锁_创建 ()
.子程序 __启动窗口_将被销毁

读写锁_销毁 (读写锁)
.子程序 线程1入口
.局部变量 i, 整数型

读写锁_开始读 (读写锁)
Debug (到文本 (GetCurrentThreadId ()) + “ 开始读”)
延时 (100 + 位与 (i, 63))
Debug (到文本 (GetCurrentThreadId ()) + “ 结束读”)
读写锁_结束读 (读写锁)
.子程序 线程2入口
.局部变量 i, 整数型

读写锁_开始写 (读写锁)
Debug (到文本 (GetCurrentThreadId ()) + “ 开始写”)
延时 (100 + 位与 (i, 63))
Debug (到文本 (GetCurrentThreadId ()) + “ 结束写”)
读写锁_结束写 (读写锁)
.子程序 _按钮1_被单击
.局部变量 i, 整数型

.计次循环首 (1000, i)
    .如果真 (i % 100 == 0)
        启动线程 (&线程2入口, i, )
    .如果真结束
    启动线程 (&线程1入口, i, )
.计次循环尾 ()
.子程序 Debug
.参数 Text, 文本型

输出调试文本 (Text)
OutputDebugString (Text)